<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <h2>{{ title }}</h2>

    <div class="row" style="margin-bottom:12px;">
        <input type="text" name="subject" id="subject" placeholder="Conversation subject‚Ä¶" style="flex:1; padding:8px;">
        <label class="muted" for="subject" style="margin-right:8px;">
            {{ object_name }}
        </label>
    </div>

    <form method="post" action="{{ url_for('submit') }}" id="main-form">
        <label class="muted">‚ùì what is the question?</label>
        <textarea name="text" placeholder="Type here..." id="question-text" rows="4"></textarea>

        <div class="row">
            <button type="submit" id="submit-btn">Submit...</button>
            <label>
                <input type="checkbox" name="remove_thoughts" checked>
                <span class="muted">üß† remove thoughts</span>
            </label>
            <button type="submit" formaction="{{ url_for('prev') }}" {% if not can_prev %}disabled{% endif
                %}>Prev</button>
            <button type="submit" formaction="{{ url_for('next') }}" {% if not can_next %}disabled{% endif
                %}>Next</button>
            <span class="muted">Showing {{ idx_display }}</span>
            <button type="submit" formaction="{{ url_for('new') }}">New...</button>
        </div>
    </form>

    {% if item %}
    <div class="card">
        <div class="muted">Input</div>
        <pre>{{ item["input"] }}</pre>
        <div class="muted" style="margin-top:10px;">Reply</div>
        <pre>{{ item["reply"] }}</pre>
    </div>
    {% else %}
    <p class="muted">No interactions yet.</p>
    {% endif %}

    <hr />

    <div class="row" style="margin-bottom:12px;">
        <label class="muted" for="subject" style="margin-right:8px;">
            {{ signature }}
        </label>
    </div>

    <script>
        const textarea = document.getElementById("question-text");
        const form = document.getElementById("main-form");

        textarea.addEventListener("keydown", function (e) {
            if (e.key === "Enter" && !e.shiftKey) {
                e.preventDefault();
                form.requestSubmit();
            }
        });
    </script>
</body>

</html>